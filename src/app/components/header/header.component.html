<header class="header">
  <div class="header-container">
    <!-- Logo -->
    <div class="logo-container">
      <a routerLink="/" class="logo-link" aria-label="Arca Studios Home" (click)="closeMobileMenu()">
        <img src="/images/logo.png" alt="Arca Studios Logo" class="logo" />
      </a>
    </div>

    <!-- Desktop: Right side Navigation, Language flags, and CTA -->
    <div class="header-right">
      <!-- Navigation -->
      <nav class="nav" role="navigation" aria-label="Main navigation">
        <ul class="nav-list">
          <li class="nav-item">
            <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-link">
              {{ translations().home }}
            </a>
          </li>
          <li class="nav-item">
            <a routerLink="/about" routerLinkActive="active" class="nav-link">
              {{ translations().about }}
            </a>
          </li>
          <li class="nav-item">
            <a routerLink="/portfolio" routerLinkActive="active" class="nav-link">
              {{ translations().portfolio }}
            </a>
          </li>
          <li class="nav-item">
            <a routerLink="/contact" routerLinkActive="active" class="nav-link">
              {{ translations().contact }}
            </a>
          </li>
        </ul>
      </nav>

      <!-- Language selector with dropdown -->
      <div 
        class="language-selector-container"
        (mouseenter)="showLanguageMenu = true"
        (mouseleave)="showLanguageMenu = false"
      >
        <!-- Current language flag button -->
        <button
          type="button"
          class="flag-button current-flag"
          [attr.aria-label]="'Current language: ' + languageNames[currentLanguage()]"
          [attr.aria-expanded]="showLanguageMenu"
          [title]="languageNames[currentLanguage()]"
        >
          <img [src]="getFlagPath(currentLanguage())" [alt]="languageNames[currentLanguage()] + ' flag'" class="flag-image" />
        </button>

        <!-- Invisible bridge to prevent gap issues -->
        @if (showLanguageMenu) {
          <div class="language-dropdown-bridge"></div>
        }

        <!-- Dropdown menu with other languages -->
        @if (showLanguageMenu) {
          <div class="language-dropdown">
            @for (lang of getOtherLanguages(); track lang) {
              <button
                type="button"
                class="flag-button dropdown-flag"
                (click)="changeLanguage(lang)"
                [attr.aria-label]="'Change language to ' + languageNames[lang]"
                [title]="languageNames[lang]"
              >
                <img [src]="getFlagPath(lang)" [alt]="languageNames[lang] + ' flag'" class="flag-image" />
              </button>
            }
          </div>
        }
      </div>

      <!-- CTA Button -->
      <button 
        type="button" 
        class="cta-button"
        (click)="scrollToContact()"
        [attr.aria-label]="translations().cta"
      >
        {{ translations().cta }}
      </button>
    </div>

    <!-- Mobile: Hamburger menu button -->
    <button 
      type="button"
      class="mobile-menu-toggle"
      (click)="toggleMobileMenu()"
      [attr.aria-label]="showMobileMenu ? 'Close menu' : 'Open menu'"
      [attr.aria-expanded]="showMobileMenu"
    >
      <span class="hamburger-icon" [class.active]="showMobileMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </button>
  </div>

  <!-- Mobile menu overlay -->
  @if (showMobileMenu) {
    <div class="mobile-menu-overlay" (click)="closeMobileMenu()">
      <nav class="mobile-menu" (click)="$event.stopPropagation()">
        <ul class="mobile-nav-list">
          <li class="mobile-nav-item">
            <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="mobile-nav-link" (click)="closeMobileMenu()">
              {{ translations().home }}
            </a>
          </li>
          <li class="mobile-nav-item">
            <a routerLink="/about" routerLinkActive="active" class="mobile-nav-link" (click)="closeMobileMenu()">
              {{ translations().about }}
            </a>
          </li>
          <li class="mobile-nav-item">
            <a routerLink="/portfolio" routerLinkActive="active" class="mobile-nav-link" (click)="closeMobileMenu()">
              {{ translations().portfolio }}
            </a>
          </li>
          <li class="mobile-nav-item">
            <a routerLink="/contact" routerLinkActive="active" class="mobile-nav-link" (click)="closeMobileMenu()">
              {{ translations().contact }}
            </a>
          </li>
        </ul>

        <!-- Language selector for mobile -->
        <div class="mobile-language-selector">
          <span class="mobile-language-label">{{ translations().language }}:</span>
          <div class="mobile-language-flags">
            @for (lang of languages; track lang) {
              <button
                type="button"
                class="mobile-flag-button"
                [class.active]="currentLanguage() === lang"
                (click)="changeLanguage(lang)"
                [attr.aria-label]="'Change language to ' + languageNames[lang]"
                [title]="languageNames[lang]"
              >
                <img [src]="getFlagPath(lang)" [alt]="languageNames[lang] + ' flag'" class="flag-image" />
              </button>
            }
          </div>
        </div>

        <!-- CTA Button for mobile -->
        <button 
          type="button" 
          class="mobile-cta-button"
          (click)="scrollToContact()"
        >
          {{ translations().cta }}
        </button>
      </nav>
    </div>
  }
</header>
